query getUserQuery($sub: String!) {
  users(where: {sub: {_eq: $sub}}) {
    id
    name
    email
    sub
    imageUrl
  }
}

mutation insertUserQuery($name: String!, $email: String!, $sub: String!, $imageUrl: String) {
  insert_users(objects: {name: $name, email: $email, sub: $sub, imageUrl: $imageUrl}) {
    returning {
      id
      name
      email
      sub
      imageUrl
    }
  }}

query getBooks {
  books {
    id
    title
    isbn
    imageUrl
    createdAt
  }
}

query getBook($id: Int!) {
  books(where: {id: {_eq: $id}}) {
    id
    title
    isbn
    imageUrl
    registrationHistories {
      userId
      createdAt
    }
    lendingHistories {
      id
      createdAt
      dueDate
      user {
        id
        name
        imageUrl
        impressions(where: {bookId: {_eq: $id}}) {
          impression
          createdAt
          updatedAt
        }
      }
      returnHistories {
        
        createdAt
      }
    }
    reservations {
      userId
      reservationDate
      createdAt
    }
  }
}

mutation postLendingHistory($userId: Int!, $bookId: Int!, $dueDate: date!) {
  insert_lendingHistories_one(object: {userId: $userId, bookId: $bookId, dueDate: $dueDate}) {
    userId
    bookId
    dueDate
  }
}

mutation postReturnHistory($lendingHistoryId: Int!) {
  insert_returnHistories_one(object: {lendingHistoryId: $lendingHistoryId}) {
    id
  }
}
